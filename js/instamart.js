


window.storesData = [

    {
        id: 1,
        name: "Fresh Farm Produce",
        category: "Fruits & Veggies",
        rating: 4.8,
        deliveryTime: 15,
        deliveryFee: 0,
        distance: 1.2,
        price: "Min ₹100",
        image: "images/healthy_salad.png",
        isOpen: true
    },
    {
        id: 2,
        name: "Green Grocer",
        category: "Fruits & Veggies",
        rating: 4.6,
        deliveryTime: 25,
        deliveryFee: 15,
        distance: 2.2,
        price: "Min ₹100",
        image: "images/veggies.png",
        isOpen: true
    },
    {
        id: 3,
        name: "Organic Harvest",
        category: "Fruits & Veggies",
        rating: 4.9,
        deliveryTime: 30,
        deliveryFee: 10,
        distance: 3.5,
        price: "Min ₹200",
        image: "images/healthy_salad.png",
        isOpen: true
    },


    {
        id: 4,
        name: "Daily Needs Dairy",
        category: "Dairy & Bakery",
        rating: 4.5,
        deliveryTime: 20,
        deliveryFee: 15,
        distance: 2.5,
        price: "Min ₹150",
        image: "images/sweet_bakery_treats.png",
        isOpen: true
    },
    {
        id: 5,
        name: "Morning Fresh",
        category: "Dairy & Bakery",
        rating: 4.7,
        deliveryTime: 15,
        deliveryFee: 0,
        distance: 1.5,
        price: "Min ₹50",
        image: "images/dairy_bakery.png",
        isOpen: true
    },
    {
        id: 6,
        name: "The Bread Basket",
        category: "Dairy & Bakery",
        rating: 4.6,
        deliveryTime: 25,
        deliveryFee: 10,
        distance: 3.0,
        price: "Min ₹100",
        image: "images/fresh_bread.png",
        isOpen: true
    },
    {
        id: 7,
        name: "Creamy Delights",
        category: "Dairy & Bakery",
        rating: 4.8,
        deliveryTime: 30,
        deliveryFee: 25,
        distance: 4.2,
        price: "Min ₹200",
        image: "images/delicious_dessert.png",
        isOpen: true
    },


    {
        id: 8,
        name: "Snack Station",
        category: "Snacks & Munchies",
        rating: 4.6,
        deliveryTime: 25,
        deliveryFee: 20,
        distance: 3.0,
        price: "Min ₹100",
        image: "images/spicy_snacks.png",
        isOpen: true
    },
    {
        id: 9,
        name: "Crunchy Corner",
        category: "Snacks & Munchies",
        rating: 4.5,
        deliveryTime: 20,
        deliveryFee: 15,
        distance: 2.8,
        price: "Min ₹120",
        image: "images/snacks.png",
        isOpen: true
    },
    {
        id: 10,
        name: "Movie Night Treats",
        category: "Snacks & Munchies",
        rating: 4.7,
        deliveryTime: 35,
        deliveryFee: 10,
        distance: 4.5,
        price: "Min ₹150",
        image: "images/snacks.png",
        isOpen: true
    },


    {
        id: 11,
        name: "Liquid Lounge",
        category: "Beverages",
        rating: 4.9,
        deliveryTime: 20,
        deliveryFee: 10,
        distance: 1.8,
        price: "Min ₹150",
        image: "images/beverages.png",
        isOpen: true
    },
    {
        id: 12,
        name: "Cool Sips",
        category: "Beverages",
        rating: 4.5,
        deliveryTime: 25,
        deliveryFee: 15,
        distance: 2.5,
        price: "Min ₹100",
        image: "images/beverages.png",
        isOpen: true
    },
    {
        id: 13,
        name: "Juice Junction",
        category: "Beverages",
        rating: 4.7,
        deliveryTime: 22,
        deliveryFee: 0,
        distance: 2.0,
        price: "Min ₹120",
        image: "images/beverages.png",
        isOpen: true
    },
    {
        id: 14,
        name: "Brew Masters",
        category: "Beverages",
        rating: 4.8,
        deliveryTime: 30,
        deliveryFee: 20,
        distance: 3.5,
        price: "Min ₹180",
        image: "images/cafe_breakfast.png",
        isOpen: true
    },


    {
        id: 104,
        name: "Health Hub",
        category: "Personal Care",
        rating: 4.7,
        deliveryTime: 30,
        deliveryFee: 0,
        distance: 3.5,
        price: "Min ₹200",
        image: "images/personal_care.png",
        isOpen: true
    },
    {
        id: 123,
        name: "Glow & Shine",
        category: "Personal Care",
        rating: 4.6,
        deliveryTime: 25,
        deliveryFee: 20,
        distance: 3.0,
        price: "Min ₹250",
        image: "images/makeup.png",
        isOpen: true
    },
    {
        id: 124,
        name: "Everyday Care",
        category: "Personal Care",
        rating: 4.3,
        deliveryTime: 20,
        deliveryFee: 15,
        distance: 2.2,
        price: "Min ₹150",
        image: "images/personal_care.png",
        isOpen: true
    },
    {
        id: 125,
        name: "Beauty Basket",
        category: "Personal Care",
        rating: 4.8,
        deliveryTime: 35,
        deliveryFee: 25,
        distance: 4.0,
        price: "Min ₹300",
        image: "images/luxury_beauty_kit.jpg",
        isOpen: true
    },
    {
        id: 126,
        name: "Pure & Organic",
        category: "Personal Care",
        rating: 4.9,
        deliveryTime: 28,
        deliveryFee: 10,
        distance: 2.8,
        price: "Min ₹200",
        image: "images/pure_and_organic.jpg",
        isOpen: true
    },


    {
        id: 105,
        name: "Home Essentials",
        category: "Home Essentials",
        rating: 4.4,
        deliveryTime: 35,
        deliveryFee: 25,
        distance: 4.0,
        price: "Min ₹300",
        image: "images/home_essentials.png",
        isOpen: true
    },
    {
        id: 127,
        name: "Clean & Tidy",
        category: "Home Essentials",
        rating: 4.6,
        deliveryTime: 25,
        deliveryFee: 20,
        distance: 3.2,
        price: "Min ₹200",
        image: "images/clean_and_tidy.jpg",
        isOpen: true
    },
    {
        id: 128,
        name: "Kitchen King",
        category: "Home Essentials",
        rating: 4.7,
        deliveryTime: 30,
        deliveryFee: 15,
        distance: 2.5,
        price: "Min ₹250",
        image: "images/home_essentials.png",
        isOpen: true
    },
    {
        id: 129,
        name: "Safety First",
        category: "Home Essentials",
        rating: 4.5,
        deliveryTime: 20,
        deliveryFee: 10,
        distance: 1.8,
        price: "Min ₹150",
        image: "images/home_essentials.png",
        isOpen: true
    },
    {
        id: 130,
        name: "Daily Disposables",
        category: "Home Essentials",
        rating: 4.3,
        deliveryTime: 15,
        deliveryFee: 5,
        distance: 1.2,
        price: "Min ₹100",
        image: "images/home_essentials.png",
        isOpen: true
    }
].map(store => ({
    ...store,

    menu: (typeof generateGroceryMenu === 'function') ? generateGroceryMenu(store.category) : {}
}));


function displayStores(stores = window.storesData) {
    const grid = document.getElementById('storesGrid');
    if (!grid) return;

    grid.innerHTML = stores.map(store => `
        <div class="restaurant-card" onclick="goToStore(${store.id})">
            <div class="restaurant-image">
                <img src="${store.image}" alt="${store.name}" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="emoji-fallback">${store.name.charAt(0)}</div>
                
                <div class="image-overlay">
                    <h3 class="restaurant-name">${store.name}</h3>
                    <div class="restaurant-meta-overlay">
                        <span class="rating">
                            <i class="fas fa-star"></i> ${store.rating}
                        </span>
                        <span class="dot">•</span>
                        <span class="delivery-time">${store.deliveryTime} min</span>
                        <span class="dot">•</span>
                        <span class="price">${store.price}</span>
                    </div>
                </div>

                ${store.isOpen ? '<span class="status-badge open">Open</span>' : '<span class="status-badge closed">Closed</span>'}
            </div>
            <div class="restaurant-info">
                <div class="info-row">
                    <div class="restaurant-cuisine">${store.category}</div>
                    ${store.deliveryFee === 0 ? '<span class="free-delivery">Free Delivery</span>' : ''}
                </div>
                <div class="location-row" style="color: #666; font-size: 0.85rem; margin-bottom: 12px; display: flex; align-items: center; gap: 5px;">
                    <i class="fas fa-map-marker-alt" style="color: #ff7a3d;"></i>
                    <span class="location-text">${store.distance} km away</span>
                </div>
            </div>
        </div>
    `).join('');
}


function goToStore(storeId) {
    if (typeof localStorage !== 'undefined') {
        localStorage.setItem('selectedRestaurant', storeId);
        
        window.location.href = `restaurant-detail.html?id=${storeId}`;
    } else {
        alert("Unable to navigate. Please enable cookies/localStorage.");
    }
}


function applyFilters() {
    const sortFilter = document.getElementById('sortFilter');
    const categoryFilter = document.getElementById('categoryFilter');
    const ratingFilter = document.getElementById('ratingFilter');

    let filtered = [...storesData];


    if (categoryFilter && categoryFilter.value) {
        filtered = filtered.filter(s => s.category.includes(categoryFilter.value));
    }


    if (ratingFilter && ratingFilter.value) {
        const minRating = parseFloat(ratingFilter.value);
        if (!isNaN(minRating)) {
            filtered = filtered.filter(s => s.rating >= minRating);
        }
    }


    if (sortFilter && sortFilter.value) {
        switch (sortFilter.value) {
            case 'rating':
                filtered.sort((a, b) => b.rating - a.rating);
                break;
            case 'delivery-time':
                filtered.sort((a, b) => a.deliveryTime - b.deliveryTime);
                break;
            case 'distance':
                filtered.sort((a, b) => a.distance - b.distance);
                break;
            case 'price-low':
                filtered.sort((a, b) => {
                    const priceA = parseInt(a.price.replace(/[^\d]/g, ''));
                    const priceB = parseInt(b.price.replace(/[^\d]/g, ''));
                    return priceA - priceB;
                });
                break;
        }
    }

    displayStores(filtered);
}


document.addEventListener('DOMContentLoaded', () => {

    const urlParams = new URLSearchParams(window.location.search);
    const categoryParam = urlParams.get('category');

    if (categoryParam) {
        const categoryDropdown = document.getElementById('categoryFilter');
        if (categoryDropdown) {
            categoryDropdown.value = categoryParam;

            applyFilters();
        } else {

            const filtered = storesData.filter(s => s.category.includes(categoryParam));
            displayStores(filtered);
            return;
        }
    } else {
        displayStores();
    }
});

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="app-name" content="FoodHub">
    <title>FoodHub - Create Account</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        :root {
            --primary: #FF5200;
            --primary-hover: #E64A00;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #2D2D2D;
        }

        .auth-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.04);
        }

        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #9CA3AF;
        }

        .auth-input {
            width: 100%;
            padding: 12px 12px 12px 48px;
            border: 1.5px solid #E5E7EB;
            border-radius: 12px;
            outline: none;
            transition: all 0.2s;
        }

        .auth-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(255, 82, 0, 0.1);
        }

        .success-check {
            position: absolute;
            right: 40px;
            top: 50%;
            transform: translateY(-50%);
            color: #10B981;
            display: none;
        }

        .eye-toggle {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #9CA3AF;
        }

        .password-meter {
            height: 4px;
            background: #E5E7EB;
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }

        #meterBar {
            height: 100%;
            width: 0%;
            transition: all 0.3s ease;
        }

        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 16px 24px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateY(200%);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 2000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .parallax-pizza {
            position: absolute;
            right: -50px;
            top: 100px;
            font-size: 15rem;
            opacity: 0.05;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }


        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-box {
            background: white;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: scale(0.95);
            transition: transform 0.3s ease-out;
        }

        .modal-overlay.active .modal-box {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #4b5563;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: #e5e7eb;
            color: #111827;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1f2937;
            padding-right: 40px;
        }

        .modal-content-text {
            font-size: 15px;
            color: #4b5563;
            line-height: 1.7;
        }

        .modal-content-text p {
            margin-bottom: 15px;
        }

        .modal-content-text h4 {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-top: 25px;
            margin-bottom: 10px;
        }
    </style>
</head>

<body class="min-h-screen">

    <div id="toast" class="toast">
        <span id="toast-icon"></span>
        <span id="toast-message"></span>
    </div>


    <nav class="bg-white border-b border-gray-100 sticky top-0 z-50 py-4">
        <div class="max-w-7xl mx-auto px-6 flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-2 text-2xl font-bold text-orange-600">
                <i class="fas fa-utensils"></i>
                <span>FoodHub</span>
            </a>
            <div class="hidden md:flex gap-8 font-medium text-gray-600">
                <a href="index.html" class="hover:text-orange-600 transition">Home</a>
                <a href="#" class="hover:text-orange-600 transition">Restaurants</a>
                <a href="#" class="hover:text-orange-600 transition">Offers</a>
                <a href="#" class="hover:text-orange-600 transition">Help</a>
            </div>
            <div class="flex items-center gap-4 nav-icons">
                <a href="#" class="relative p-2 text-gray-600">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cartCount"
                        class="absolute -top-1 -right-1 bg-orange-600 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full">0</span>
                </a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-12 lg:py-20 relative overflow-hidden">
        <div class="parallax-pizza" id="parallaxPizza">🍕</div>

        <div class="grid lg:grid-cols-2 gap-16 items-center">


            <div>
                <div class="auth-card p-8 md:p-12">
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold mb-2">Join FoodHub!</h1>
                        <p class="text-gray-500">Create an account to start ordering delicious food.</p>
                    </div>

                    <form id="signupForm" class="space-y-5">

                        <div class="space-y-1">
                            <label class="text-xs font-bold uppercase tracking-wider text-gray-500">Full Name</label>
                            <div class="input-wrapper">
                                <i class="fas fa-user input-icon"></i>
                                <input type="text" id="fullname" class="auth-input" placeholder="Enter your full name"
                                    required autocomplete="off">
                                <i class="fas fa-check-circle success-check" id="nameCheck"></i>
                            </div>
                        </div>


                        <div class="space-y-1">
                            <label class="text-xs font-bold uppercase tracking-wider text-gray-500">Email
                                Address</label>
                            <div class="input-wrapper">
                                <i class="fas fa-envelope input-icon"></i>
                                <input type="email" id="signup-email" class="auth-input" placeholder="your@email.com"
                                    required autocomplete="off">
                                <i class="fas fa-check-circle success-check" id="emailCheck"></i>
                            </div>
                        </div>


                        <div class="space-y-1">
                            <label class="text-xs font-bold uppercase tracking-wider text-gray-500">Phone Number</label>
                            <div class="input-wrapper flex items-center">
                                <i class="fas fa-phone input-icon"></i>
                                <select id="countryCode"
                                    class="absolute left-10 text-gray-700 font-medium border-r border-gray-300 pr-1 bg-transparent outline-none cursor-pointer"
                                    style="height: 24px; top: 18px; border: none; border-right: 2px solid #ddd; width: 85px; font-size: 14px;">
                                    <option value="+91">+91 (IN)</option>
                                    <option value="+1">+1 (US)</option>
                                    <option value="+44">+44 (UK)</option>
                                    <option value="+61">+61 (AU)</option>
                                    <option value="+81">+81 (JP)</option>
                                    <option value="+86">+86 (CN)</option>
                                    <option value="+971">+971 (AE)</option>
                                    <option value="+33">+33 (FR)</option>
                                    <option value="+49">+49 (DE)</option>
                                </select>
                                <input type="tel" id="phone" class="auth-input pl-[8.5rem]" placeholder="Phone number"
                                    required autocomplete="off">
                                <i class="fas fa-check-circle success-check" id="phoneCheck"></i>
                            </div>
                        </div>


                        <div class="space-y-1">
                            <label class="text-xs font-bold uppercase tracking-wider text-gray-500">Password</label>
                            <div class="input-wrapper">
                                <i class="fas fa-lock input-icon"></i>
                                <input type="password" id="signup-password" class="auth-input"
                                    placeholder="Min 8 characters" required autocomplete="new-password">
                                <span class="eye-toggle" onclick="togglePass('signup-password')"><i
                                        class="fas fa-eye"></i></span>
                            </div>
                            <div class="password-meter">
                                <div id="meterBar"></div>
                            </div>
                            <div class="flex justify-between mt-1">
                                <span id="strengthText" class="text-[10px] font-bold uppercase"></span>
                            </div>
                        </div>


                        <div class="space-y-1">
                            <label class="text-xs font-bold uppercase tracking-wider text-gray-500">Confirm
                                Password</label>
                            <div class="input-wrapper">
                                <i class="fas fa-lock input-icon"></i>
                                <input type="password" id="confirm-password" class="auth-input"
                                    placeholder="Repeat password" required autocomplete="new-password">
                                <span class="eye-toggle" onclick="togglePass('confirm-password')"><i
                                        class="fas fa-eye"></i></span>
                            </div>
                            <p id="confirmError" class="text-red-500 text-[10px] mt-1 italic"></p>
                        </div>


                        <div class="flex items-start gap-3 py-2">
                            <input type="checkbox" id="agree"
                                class="mt-1 w-4 h-4 accent-orange-600 rounded cursor-pointer" required>
                            <label for="agree" class="text-sm text-gray-600 leading-tight cursor-pointer">
                                I agree to the <a href="#" onclick="openModal('termsModal'); return false;"
                                    class="text-orange-600 font-bold hover:underline">Terms</a>
                                and <a href="#" onclick="openModal('privacyModal'); return false;"
                                    class="text-orange-600 font-bold hover:underline">Privacy Policy</a>
                            </label>
                        </div>

                        <button type="submit" id="signupBtn"
                            class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-4 rounded-xl transition flex items-center justify-center gap-2">
                            <span id="btnText">Create Account</span>
                            <i class="fas fa-arrow-right" id="btnIcon"></i>
                        </button>
                    </form>

                    <div class="text-center mt-8 text-sm text-gray-500">
                        Already have an account? <a href="login.html"
                            class="text-orange-600 font-bold hover:underline">Sign
                            In</a>
                    </div>
                </div>
            </div>


            <div class="hidden lg:flex flex-col items-center justify-center text-center space-y-8">
                <div class="relative">
                    <img src="images/floating-pizza.png" alt="Delicious Floating Pizza"
                        class="w-[500px] h-auto relative block animate-float">
                </div>
                <div>
                    <h2 class="text-4xl font-black text-gray-900 leading-tight">Craving something <br> delicious?</h2>
                    <p class="text-gray-500 mt-4 text-lg">Join thousands of foodies ordering from <br> the best local
                        restaurants.</p>
                </div>
                <div class="flex gap-4">
                    <div class="bg-white p-4 rounded-2xl shadow-sm flex items-center gap-3">
                        <i class="fas fa-star text-yellow-400"></i>
                        <span class="font-bold">4.9 Rating</span>
                    </div>
                    <div class="bg-white p-4 rounded-2xl shadow-sm flex items-center gap-3">
                        <i class="fas fa-clock text-blue-500"></i>
                        <span class="font-bold">Fast Delivery</span>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script>

        let cartCount = parseInt(localStorage.getItem('foodhub_cart_count')) || 0;


        const form = document.getElementById('signupForm');
        const signupBtn = document.getElementById('signupBtn');
        const btnText = document.getElementById('btnText');
        const btnIcon = document.getElementById('btnIcon');
        const toast = document.getElementById('toast');
        const passwordInput = document.getElementById('signup-password');
        const confirmInput = document.getElementById('confirm-password');


        window.onload = () => {
            document.getElementById('cartCount').textContent = cartCount;
            document.getElementById('cartCount').style.display = cartCount > 0 ? 'flex' : 'none';
        }


        function showToast(message, type = 'success') {
            const msg = document.getElementById('toast-message');
            const icon = document.getElementById('toast-icon');
            msg.textContent = message;
            icon.innerHTML = type === 'success'
                ? '<i class="fas fa-check-circle text-green-500 text-xl"></i>'
                : '<i class="fas fa-times-circle text-red-500 text-xl"></i>';
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }


        function togglePass(id) {
            const input = document.getElementById(id);
            const icon = input.nextElementSibling.querySelector('i');
            input.type = input.type === 'password' ? 'text' : 'password';
            icon.classList.toggle('fa-eye');
            icon.classList.toggle('fa-eye-slash');
        }


        function setValidation(id, isValid) {
            const check = document.getElementById(`${id}Check`);
            if (check) check.style.display = isValid ? 'block' : 'none';
        }

        document.getElementById('fullname').addEventListener('input', e => {
            setValidation('name', e.target.value.trim().length > 2);
        });

        document.getElementById('signup-email').addEventListener('input', e => {
            const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            setValidation('email', regex.test(e.target.value));
        });

        document.getElementById('phone').addEventListener('input', e => {
            setValidation('phone', e.target.value.replace(/\D/g, '').length >= 10);
        });


        passwordInput.addEventListener('input', e => {
            const val = e.target.value;
            const bar = document.getElementById('meterBar');
            const text = document.getElementById('strengthText');

            let strength = 0;
            if (val.length >= 8) strength += 25;
            if (/[A-Z]/.test(val)) strength += 25;
            if (/[0-9]/.test(val)) strength += 25;
            if (/[^A-Za-z0-9]/.test(val)) strength += 25;

            bar.style.width = strength + '%';

            if (strength <= 25) { bar.style.backgroundColor = '#EF4444'; text.textContent = 'Weak'; text.style.color = '#EF4444'; }
            else if (strength <= 50) { bar.style.backgroundColor = '#F59E0B'; text.textContent = 'Fair'; text.style.color = '#F59E0B'; }
            else if (strength <= 75) { bar.style.backgroundColor = '#3B82F6'; text.textContent = 'Good'; text.style.color = '#3B82F6'; }
            else { bar.style.backgroundColor = '#10B981'; text.textContent = 'Strong'; text.style.color = '#10B981'; }

            checkPasswords();
        });


        confirmInput.addEventListener('input', checkPasswords);

        function checkPasswords() {
            const error = document.getElementById('confirmError');
            if (confirmInput.value && confirmInput.value !== passwordInput.value) {
                error.textContent = "Passwords don't match";
            } else {
                error.textContent = "";
            }
        }



        let pendingEmail = '';

        function closeVerifyModal() {
            document.getElementById('verifyModal').classList.remove('flex');
            document.getElementById('verifyModal').classList.add('hidden');
        }

        async function submitVerification() {
            const code = document.getElementById('verificationCode').value.trim();
            const btn = document.getElementById('verifyBtn');

            if (code.length < 6) {
                showToast('Please enter the full 6-digit code', 'error');
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-circle-notch spinner"></i> Verifying...';

            try {
                // Using the api object instead of fetch
                const response = await api.post('/auth/verify', { email: pendingEmail, code });

                if (response.success) {
                    showToast('Email verified! Please sign in.', 'success');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 1500);
                } else {
                    throw new Error(response.message || 'Verification failed');
                }
            } catch (error) {
                showToast(error.message, 'error');
                btn.disabled = false;
                btn.innerHTML = '<span>Verify Account</span><i class="fas fa-check-circle"></i>';
            }
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (passwordInput.value !== confirmInput.value) {
                showToast("Passwords must match!", "error");
                return;
            }

            signupBtn.disabled = true;
            btnText.textContent = "Creating Account...";
            btnIcon.className = "fas fa-circle-notch spinner";

            try {
                const fullName = document.getElementById('fullname').value;
                const nameParts = fullName.trim().split(' ');
                const firstName = nameParts[0];
                const lastName = nameParts.slice(1).join(' ') || '';
                const email = document.getElementById('signup-email').value;

                const response = await api.register({
                    firstName,
                    lastName,
                    email,
                    phone: document.getElementById('phone').value,
                    password: passwordInput.value
                });

                if (response.success) {
                    if (response.verified === false) {
                        pendingEmail = email;
                        document.getElementById('verifyEmailDisplay').textContent = email;
                        document.getElementById('verifyModal').classList.remove('hidden');
                        document.getElementById('verifyModal').classList.add('flex');

                        showToast('Verification code sent!', 'info');

                        signupBtn.disabled = false;
                        btnText.textContent = "Create Account";
                        btnIcon.className = "fas fa-arrow-right";
                    } else {
                        showToast("Account created successfully! Welcome to FoodHub.", "success");
                        setTimeout(() => {
                            btnText.textContent = "Redirecting...";
                            window.location.href = 'index.html';
                        }, 1500);
                    }
                } else {
                    throw new Error(response.message || 'Registration failed');
                }
            } catch (error) {
                console.error('Signup error:', error);

                const errorMsg = error.message.toLowerCase();
                if (errorMsg.includes('already registered') || errorMsg.includes('already exists')) {
                    showToast('Account already exists! Redirecting to Log In...', 'info');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 2000);
                } else {
                    showToast(error.message, 'error');
                    signupBtn.disabled = false;
                    btnText.textContent = "Create Account";
                    btnIcon.className = "fas fa-arrow-right";
                }
            }
        });


        window.addEventListener('scroll', () => {
            const scroll = window.pageYOffset;
            document.getElementById('parallaxPizza').style.transform = `translateY(${scroll * 0.3}px)`;
        });
    </script>

    <div id="verifyModal"
        class="fixed inset-0 bg-black bg-opacity-50 z-[100] hidden items-center justify-center backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full mx-4 animate-fade-in relative">
            <button onclick="closeVerifyModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <i class="fas fa-times text-xl"></i>
            </button>
            <div class="text-center mb-6">
                <div
                    class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-600 text-2xl">
                    <i class="fas fa-envelope-open-text"></i>
                </div>
                <h3 class="text-2xl font-bold mb-2">Verify Email</h3>
                <p class="text-gray-500 text-sm">We sent a 6-digit code to <span id="verifyEmailDisplay"
                        class="font-bold text-gray-700"></span></p>
            </div>

            <div class="space-y-4">
                <input type="text" id="verificationCode" placeholder="Enter 6-digit code" maxlength="6"
                    class="w-full text-center text-2xl tracking-[0.5em] font-bold py-3 border-2 border-gray-200 rounded-xl focus:border-orange-600 outline-none transition uppercase">

                <button id="verifyBtn" onclick="submitVerification()"
                    class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded-xl transition flex items-center justify-center gap-2">
                    <span>Verify Account</span>
                    <i class="fas fa-check-circle"></i>
                </button>

                <button onclick="resendCode()" class="w-full text-orange-600 font-semibold text-sm hover:underline">
                    Resend Code
                </button>
            </div>
        </div>
    </div>


    <div id="termsModal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-close" onclick="closeModal('termsModal')">
                <i class="fas fa-times"></i>
            </div>
            <h3 class="modal-title">Terms & Conditions</h3>
            <div class="modal-content-text">
                <p>Welcome to FoodHub. By using our website and services, you agree to these Terms and Conditions.</p>

                <h4>1. Account Registration</h4>
                <p>To use certain features of the app, you must register for an account. You agree to provide accurate,
                    current, and complete information during the registration process.</p>

                <h4>2. Orders and Deliveries</h4>
                <p>Delivery times quoted at the time of ordering are approximate only and may vary. FoodHub will make
                    every effort to deliver within the time stated; however, we will not be liable for any loss caused
                    to you by late delivery.</p>

                <h4>3. User Conduct</h4>
                <p>You agree not to use the service for any unlawful purpose or in any way that interrupts, damages, or
                    impairs the service.</p>

                <h4>4. Payment</h4>
                <p>All prices are listed in INR. Payment must be made at the time of ordering via credit card, debit
                    card, or UPI. Cash on Delivery may be available in select areas.</p>

                <p class="mt-4 pt-4 border-t text-sm text-gray-400">Last updated: February 2026</p>
            </div>
        </div>
    </div>


    <div id="privacyModal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-close" onclick="closeModal('privacyModal')">
                <i class="fas fa-times"></i>
            </div>
            <h3 class="modal-title">Privacy Policy</h3>
            <div class="modal-content-text">
                <p>Your privacy is important to us. This policy outlines how we collect, use, and protect your personal
                    information.</p>

                <h4>1. Information We Collect</h4>
                <p>We collect information you provide directly to us, such as your name, email address, phone number,
                    and delivery address when you create an account or place an order.</p>

                <h4>2. How We Use Your Information</h4>
                <p>We use your information to provide, maintain, and improve our services, process transactions, and
                    communicate with you about your orders and account.</p>

                <h4>3. Data Security</h4>
                <p>We implement appropriate security measures to protect your personal information against unauthorized
                    access, alteration, disclosure, or destruction.</p>

                <h4>4. Sharing of Information</h4>
                <p>We do not sell your personal information. We may share your information with third-party service
                    providers (like restaurants and delivery partners) solely to fulfill your orders.</p>

                <p class="mt-4 pt-4 border-t text-sm text-gray-400">Last updated: February 2026</p>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
    <script src="js/cart-handler.js"></script>
    <script src="js/cart-sidebar.js"></script>
    <script src="js/interactive.js"></script>
    <script>
        function handleSocialLogin(provider) {
            const endpoint = provider === 'Google' ? 'google' : 'facebook';
            // Use the API's base URL instead of hardcoded 5000
            window.location.href = `${api.baseURL}/auth/${endpoint}`;
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = '';
        }


        window.onclick = function (event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
    </script>
</body>

</html>